<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GBE Achievements Viewer</title>
    <style>
        /* ... keep all your existing CSS ... */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ GBE Achievements Viewer</h1>
        </header>

        <div id="info" class="info" style="display: none;">
            <h3>üìÅ Folder Structure Expected:</h3>
            <p>Place your achievement files in: <code>AppID/&lt;game-appid&gt;/achievements.json</code></p>
            <p style="margin-top: 10px;">Example: <code>AppID/730/achievements.json</code> for Counter-Strike 2</p>
        </div>

        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <div>Scanning for achievement files...</div>
        </div>

        <div id="summary" style="display: none;"></div>
        <div id="results"></div>
    </div>

    <script>
        const appIdsToLoad = [];
        const gamesData = new Map();

        async function init() {
            try {
                const manifestResponse = await fetch('AppID/manifest.json');
                if (manifestResponse.ok) {
                    const manifest = await manifestResponse.json();
                    if (manifest.appids && Array.isArray(manifest.appids)) {
                        for (let appId of manifest.appids) {
                            appIdsToLoad.push(appId);
                        }
                    }
                }
            } catch (error) {
                console.log('No manifest.json found, will need manual configuration');
            }

            if (appIdsToLoad.length === 0) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('info').style.display = 'block';
                document.getElementById('results').innerHTML = `<div class="error">No AppIDs configured</div>`;
                return;
            }

            await loadAllGames();
        }

        async function loadAllGames() {
            const loadingDiv = document.getElementById('loading');
            let loadedCount = 0;

            for (let appId of appIdsToLoad) {
                try {
                    loadingDiv.innerHTML = `<div class="loading-spinner"></div><div>Loading game ${++loadedCount} of ${appIdsToLoad.length}...</div>`;
                    const achievementsPath = `AppID/${appId}/achievements.json`;
                    const response = await fetch(achievementsPath);
                    if (!response.ok) continue;
                    const data = await response.json();
                    await processGameData(appId, data);
                } catch (error) {
                    console.error(`Error loading AppID ${appId}:`, error);
                }
            }

            document.getElementById('loading').style.display = 'none';
            displayGames();
        }

        async function processGameData(appId, achievementsData) {
            const achievements = [];
            let achData = achievementsData.achievements || achievementsData;
            for (let key in achData) {
                const ach = achData[key];
                achievements.push({
                    apiname: key,
                    name: ach.name || ach.displayName || key,
                    description: ach.description || ach.desc || '',
                    icon: ach.icon || '',
                    icongray: ach.icongray || ach.icon_gray || ach.icon || '',
                    unlocked: ach.earned || ach.unlocked || ach.achieved || false,
                    unlocktime: ach.earned_time || ach.unlock_time || ach.unlocktime || 0
                });
            }

            gamesData.set(appId, {
                appId,
                name: `Game ${appId}`,
                achievements
            });
        }

        function displayGames() {
            const resultsDiv = document.getElementById('results');
            const summaryDiv = document.getElementById('summary');
            if (gamesData.size === 0) {
                resultsDiv.innerHTML = '<div class="error">No games with achievements found.</div>';
                return;
            }

            let totalGames = gamesData.size;
            let totalAchievements = 0;
            let totalUnlocked = 0;

            for (let game of gamesData.values()) {
                totalAchievements += game.achievements.length;
                totalUnlocked += game.achievements.filter(a => a.unlocked).length;
            }

            const overallPercentage = totalAchievements > 0 ? Math.round((totalUnlocked / totalAchievements) * 100) : 0;

            summaryDiv.style.display = 'block';
            summaryDiv.innerHTML = `<div class="summary">...</div>`; // Keep your summary HTML

            let html = '<div class="games-grid">';

            const sortedGames = Array.from(gamesData.values()).sort((a, b) => {
                const aPercent = a.achievements.length > 0 ? a.achievements.filter(x => x.unlocked).length / a.achievements.length : 0;
                const bPercent = b.achievements.length > 0 ? b.achievements.filter(x => x.unlocked).length / b.achievements.length : 0;
                return bPercent - aPercent;
            });

            for (let game of sortedGames) {
                const unlocked = game.achievements.filter(a => a.unlocked).length;
                const total = game.achievements.length;
                const percentage = total > 0 ? Math.round((unlocked / total) * 100) : 0;
                const cardId = `game-${game.appId}`;

                html += `
                <div class="game-card">
                    <div class="game-header">
                        <img src="https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/${game.appId}/header.jpg"
                             alt="${game.name}" class="game-icon"
                             onerror="this.style.display='none'">
                        <div class="game-info">
                            <div class="game-title">${game.name}</div>
                            <div class="game-appid">AppID: ${game.appId}</div>
